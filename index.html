<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>GoldCrypto</title>
<style>
  body {background:#101020;color:#eee;font-family:"Cairo",sans-serif;text-align:center;padding:20px;}
  h1 {color:#f7c948;}
  .hidden{display:none;}
  div.panel{background:#1e1e3f;padding:20px;border-radius:12px;margin:20px auto;max-width:900px;box-shadow:0 0 15px #ffcc0070;}
  label{display:block;margin:10px 0 5px;}
  input,button{padding:10px;border-radius:8px;border:none;width:100%;max-width:300px;margin:5px auto;display:block;font-size:16px;}
  button{background:#f7c948;color:#222;font-weight:bold;cursor:pointer;}
  button:hover{background:#ffdb70;}
  table{width:100%;border-collapse:collapse;margin:20px 0;background:#222244;color:#eee;border-radius:8px;overflow:hidden;}
  th,td{padding:10px;border-bottom:1px solid #444;}
  th{background:#f7c948;color:#222;}
  .walletBox{background:#2a2a4d;padding:10px;margin:10px 0;border-radius:8px;text-align:right;}
  .deleteBtn{background:#d33 !important;color:#fff !important;}
  pre{background:#111131;padding:10px;border-radius:8px;text-align:right;max-height:300px;overflow-y:auto;}
</style>
</head>
<body>

<h1>نظام GoldCrypto</h1>

<!-- تسجيل الدخول -->
<div id="loginPage" class="panel">
  <h2>تسجيل الدخول</h2>
  <label>اسم المستخدم:</label>
  <input id="loginUsername" type="text">
  <label>كود الحساب:</label>
  <input id="loginCode" type="text">
  <label>كلمة المرور:</label>
  <input id="loginPassword" type="password">
  <button onclick="login()">دخول</button>
  <p id="loginError" style="color:#f55;font-weight:bold;"></p>
</div>

<!-- صفحة المستخدم -->
<div id="userPage" class="panel hidden">
  <h2>مرحبا <span id="userNameDisplay"></span></h2>
  <h3>رصيدك:</h3>
  <table id="userBalanceTable"><thead><tr><th>العملة</th><th>الرصيد</th></tr></thead><tbody></tbody></table>
  <h3>أسعار العملات:</h3>
  <table id="pricesTableUser"><thead><tr><th>العملة</th><th>السعر</th></tr></thead><tbody></tbody></table>
  <button onclick="logout()">تسجيل خروج</button>
</div>

<!-- الإدارة العادية -->
<div id="adminPage" class="panel hidden">
  <h2>لوحة الإدارة</h2>
  <input id="adminSearchInput" type="text" placeholder="ابحث باسم أو كود الحساب" oninput="adminSearch()">
  <div id="adminSearchResults"></div>
  <h3>أسعار العملات:</h3>
  <table id="pricesTableAdmin"><thead><tr><th>العملة</th><th>السعر</th></tr></thead><tbody></tbody></table>
  <button onclick="logout()">تسجيل خروج</button>
</div>

<!-- الإدارة العليا -->
<div id="superAdminPage" class="panel hidden">
  <h2>لوحة الإدارة العليا</h2>
  <div>
    <button onclick="showAddWallet()">إضافة محفظة</button>
    <button onclick="showPriceEditor()">تعديل الأسعار</button>
    <button onclick="showGlobalReport()">تقرير شامل</button>
    <button onclick="logout()">تسجيل خروج</button>
  </div>
  
  <div id="addWalletSection" class="hidden">
    <h3>إضافة محفظة جديدة</h3>
    <input id="newWalletName" type="text" placeholder="اسم المستخدم">
    <input id="newWalletCode" type="text" placeholder="كود المحفظة">
    <input id="newWalletPass" type="password" placeholder="كلمة المرور">
    <button onclick="addNewWallet()">إنشاء</button>
    <p id="addWalletMsg" style="color:#7f7"></p>
  </div>

  <div id="priceEditorSection" class="hidden">
    <h3>تعديل أسعار العملات</h3>
    <table id="priceEditorTable"><thead><tr><th>العملة</th><th>السعر الحالي</th><th>تعديل</th></tr></thead><tbody></tbody></table>
    <button onclick="savePrices()">حفظ</button>
  </div>

  <div id="globalReportSection" class="hidden">
    <h3>تقرير شامل</h3>
    <pre id="globalReportContent"></pre>
  </div>

  <h3>بحث وتعديل الحسابات</h3>
  <input id="superAdminSearchInput" type="text" placeholder="ابحث..." oninput="superAdminSearch()">
  <div id="superAdminSearchResults"></div>
</div>

<script>
let currencies=[{code:"BTC",price:1000},{code:"DASH",price:250},{code:"NANO",price:120}];
let wallets=[
  {userName:"ali",walletCode:"A1234",password:"123",balances:{BTC:1,DASH:2,NANO:5}},
];
let currentUser=null;

function login(){
  let u=document.getElementById("loginUsername").value.trim();
  let c=document.getElementById("loginCode").value.trim();
  let p=document.getElementById("loginPassword").value.trim();
  let err=document.getElementById("loginError");err.textContent="";
  
  if(p==="TECNO LD7"){showPage("adminPage");currentUser="admin";loadPrices();return;}
  if(p.startsWith("TECNO ")){showPage("superAdminPage");currentUser="super";loadPrices();loadPriceEditor();return;}
  
  let w=wallets.find(x=>x.userName===u && x.walletCode===c && x.password===p);
  if(!w){err.textContent="بيانات الدخول خاطئة";return;}
  currentUser=w;showPage("userPage");loadUserPage();
}

function logout(){currentUser=null;showPage("loginPage");}

function showPage(id){
  document.querySelectorAll(".panel").forEach(e=>e.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function loadUserPage(){
  document.getElementById("userNameDisplay").textContent=currentUser.userName;
  let tb=document.querySelector("#userBalanceTable tbody");tb.innerHTML="";
  for(let c in currentUser.balances){
    tb.innerHTML+=`<tr><td>${c}</td><td>${currentUser.balances[c]}</td></tr>`;
  }
  let tp=document.querySelector("#pricesTableUser tbody");tp.innerHTML="";
  currencies.forEach(c=>tp.innerHTML+=`<tr><td>${c.code}</td><td>${c.price}</td></tr>`);
}

function loadPrices(){
  let tbs=["pricesTableAdmin"]; 
  tbs.forEach(id=>{
    let tb=document.querySelector("#"+id+" tbody");tb.innerHTML="";
    currencies.forEach(c=>tb.innerHTML+=`<tr><td>${c.code}</td><td>${c.price}</td></tr>`);
  });
}

function adminSearch(){
  let val=document.getElementById("adminSearchInput").value.toLowerCase();
  let cont=document.getElementById("adminSearchResults");cont.innerHTML="";
  let res=wallets.filter(w=>w.userName.toLowerCase().includes(val)||w.walletCode.toLowerCase().includes(val));
  res.forEach(w=>{
    let div=document.createElement("div");
    div.className="walletBox";
    div.innerHTML=`<b>${w.userName}</b> - ${w.walletCode}<br>BTC:${w.balances.BTC} DASH:${w.balances.DASH} NANO:${w.balances.NANO}`;
    cont.appendChild(div);
  });
}

// الإدارة العليا
function showAddWallet(){hideSections();document.getElementById("addWalletSection").classList.remove("hidden");}
function showPriceEditor(){hideSections();document.getElementById("priceEditorSection").classList.remove("hidden");}
function showGlobalReport(){hideSections();document.getElementById("globalReportSection").classList.remove("hidden");generateGlobalReport();}
function hideSections(){["addWalletSection","priceEditorSection","globalReportSection"].forEach(id=>document.getElementById(id).classList.add("hidden"));}

function addNewWallet(){
  let n=document.getElementById("newWalletName").value.trim();
  let code=document.getElementById("newWalletCode").value.trim();
  let pass=document.getElementById("newWalletPass").value.trim();
  if(!n||!code||!pass)return alert("املأ جميع الحقول");
  wallets.push({userName:n,walletCode:code,password:pass,balances:{BTC:0,DASH:0,NANO:0}});
  document.getElementById("addWalletMsg").textContent="تمت إضافة المحفظة!";
}

function loadPriceEditor(){
  let tb=document.querySelector("#priceEditorTable tbody");tb.innerHTML="";
  currencies.forEach((c,i)=>{
    tb.innerHTML+=`<tr><td>${c.code}</td><td>${c.price}</td><td><input type='number' value='${c.price}' id='priceInput${i}'></td></tr>`;
  });
}
function savePrices(){
  currencies.forEach((c,i)=>c.price=parseFloat(document.getElementById('priceInput'+i).value)||c.price);
  alert("تم الحفظ");loadPrices();
}

function generateGlobalReport(){
  let txt="";
  wallets.forEach(w=>{
    txt+=`${w.userName} (${w.walletCode}) => BTC:${w.balances.BTC}, DASH:${w.balances.DASH}, NANO:${w.balances.NANO}\n`;
  });
  document.getElementById("globalReportContent").textContent=txt;
}

function superAdminSearch(){
  let val=document.getElementById("superAdminSearchInput").value.toLowerCase();
  let cont=document.getElementById("superAdminSearchResults");cont.innerHTML="";
  let res=wallets.filter(w=>w.userName.toLowerCase().includes(val)||w.walletCode.toLowerCase().includes(val));
  res.forEach(w=>{
    let div=document.createElement("div");div.className="walletBox";
    div.innerHTML=`<b>${w.userName}</b> - ${w.walletCode}<br>
    BTC:${w.balances.BTC} DASH:${w.balances.DASH} NANO:${w.balances.NANO}<br>
    <button onclick="deleteWallet('${w.walletCode}')" class="deleteBtn">حذف الحساب</button>`;
    cont.appendChild(div);
  });
}

function deleteWallet(code){
  if(!confirm("هل أنت متأكد من الحذف؟"))return;
  wallets=wallets.filter(w=>w.walletCode!==code);
  superAdminSearch();
}
</script>
</body>
</html>