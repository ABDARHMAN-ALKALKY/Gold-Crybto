<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>GoldCrypto Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„ÙŠØ§</title>
<style>
  body {
    background: linear-gradient(to bottom, #1e1e2f, #292945);
    color: #f5f5f5;
    font-family: "Cairo", sans-serif;
    text-align: center;
    padding: 20px;
  }
  h1, h2 { color: #ffcc00; }
  .hidden { display: none; }
  input, select, button, textarea {
    margin: 6px;
    padding: 8px;
    border-radius: 6px;
    border: none;
    text-align: center;
    font-size: 16px;
  }
  button {
    background: #ffcc00;
    color: #000;
    cursor: pointer;
    font-weight: bold;
    border-radius: 8px;
    padding: 10px 20px;
  }
  button:hover { background: #ffd633; }
  table {
    margin: 20px auto;
    width: 90%;
    border-collapse: collapse;
    background: #2f2f47;
    border-radius: 12px;
    overflow: hidden;
    color: #f5f5f5;
  }
  th, td {
    padding: 12px;
    border-bottom: 1px solid #444;
  }
  th {
    background-color: #ffcc00;
    color: #000;
  }
  textarea {
    width: 90%;
    height: 150px;
    background: #1e1e2f;
    color: #fff;
    resize: none;
  }
  #lastOperation {
    margin-top: 15px;
    background: #00c896;
    color: #fff;
    padding: 10px;
    border-radius: 8px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>GoldCrypto Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</h1>

<div id="loginDiv">
  <h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</h2>
  <input type="password" id="adminPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" />
  <button onclick="adminLogin()">Ø¯Ø®ÙˆÙ„</button>
  <p>Ø§Ø³ØªØ®Ø¯Ù… ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø®Ø§ØµØ©: <b>TECNO LKL</b></p>
</div>

<div id="adminPanel" class="hidden">
  <h2>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</h2>

  <section>
    <h3>ğŸ” Ø¨Ø­Ø« ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3>
    <input type="text" id="searchAccountInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯" oninput="searchAccounts()" />
    <div id="searchResults"></div>
  </section>

  <section>
    <h3>ğŸ“ˆ ØªØ¹Ø¯ÙŠÙ„ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h3>
    <table>
      <thead>
        <tr>
          <th>Ø§Ù„Ø¹Ù…Ù„Ø©</th><th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ (G)</th><th>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¹Ø±</th>
        </tr>
      </thead>
      <tbody id="priceEditTable"></tbody>
    </table>
    <button onclick="savePrices()">Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</button>
  </section>

  <section>
    <h3>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„</h3>
    <button onclick="showFullReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„</button>
    <textarea id="fullReport" readonly></textarea>
  </section>

  <section>
    <h3>â° Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</h3>
    <button onclick="resetAll()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØ£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª</button>
  </section>

  <section>
    <h3>â• Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
    <input type="text" id="newAccountName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" />
    <input type="text" id="newAccountCard" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨Ù†ÙƒÙŠØ©" />
    <input type="password" id="newAccountPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" />
    <button onclick="addAccount()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨</button>
  </section>

  <section>
    <h3>âš¡ï¸ Ø¹Ù…Ù„ÙŠØ§Øª Ø´Ø±Ø§Ø¡ ÙˆØ¨ÙŠØ¹</h3>
    <select id="accountSelect"></select>
    <select id="cryptoSelect">
      <option value="nano">Nano</option>
      <option value="dash">DASH</option>
      <option value="btc">Bitcoin</option>
    </select>
    <select id="operationType">
      <option value="buy">Ø´Ø±Ø§Ø¡</option>
      <option value="sell">Ø¨ÙŠØ¹</option>
    </select>
    <input type="number" id="operationAmount" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" min="1" />
    <button onclick="addOperation()">ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
    <div id="lastOperation" class="hidden">
      <p id="lastOperationText"></p>
      <button onclick="copyLastOperation()">Ù†Ø³Ø® Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
    </div>
  </section>

  <section>
    <h3>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h3>
    <textarea id="operationsLog" readonly></textarea>
  </section>

</div>

<script>
  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  const dailyLimits = { nano: 10, dash: 3, btc: 1 };
  let cryptos = {
    nano: { name: "Nano", price: 120 },
    dash: { name: "DASH", price: 250 },
    btc: { name: "Bitcoin", price: 1000 }
  };

  let accounts = [];
  let lastAccountIndex = -1; // Ù„ØªØ¹Ù‚Ø¨ Ø¢Ø®Ø± ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù…

  // Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ
  function generateAccountCode() {
    lastAccountIndex++;
    let codeNum = lastAccountIndex.toString().padStart(3, '0');
    return `Z${codeNum}Z`;
  }

  // Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§
  function adminLogin() {
    const pass = document.getElementById("adminPassword").value.trim();
    if (pass === "TECNO LKL") {
      document.getElementById("loginDiv").classList.add("hidden");
      document.getElementById("adminPanel").classList.remove("hidden");
      updateAccountSelect();
      renderPriceEditTable();
      updateOperationsLog();
    } else {
      alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©!");
    }
  }

  // Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
  function addAccount() {
    const name = document.getElementById("newAccountName").value.trim();
    const card = document.getElementById("newAccountCard").value.trim();
    const pass = document.getElementById("newAccountPass").value.trim();
    if (!name || !card || !pass) {
      alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
      return;
    }
    if (accounts.some(acc => acc.name === name || acc.card === card)) {
      alert("Ø§Ø³Ù… Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹");
      return;
    }
    const code = generateAccountCode();
    accounts.push({
      code,
      name,
      card,
      password: pass,
      balances: { nano: 0, dash: 0, btc: 0 },
      operations: []
    });
    alert(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨!\nÙƒÙˆØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨: ${code}`);
    document.getElementById("newAccountName").value = "";
    document.getElementById("newAccountCard").value = "";
    document.getElementById("newAccountPass").value = "";
    updateAccountSelect();
  }

  // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
  function updateAccountSelect() {
    const sel = document.getElementById("accountSelect");
    sel.innerHTML = "";
    accounts.forEach((acc, i) => {
      let opt = document.createElement("option");
      opt.value = i;
      opt.textContent = `${acc.name} - ${acc.code}`;
      sel.appendChild(opt);
    });
  }

  // ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø´Ø±Ø§Ø¡ Ø£Ùˆ Ø¨ÙŠØ¹
  function addOperation() {
    clearLastOperation();

    const accIndex = +document.getElementById("accountSelect").value;
    const cryptoKey = document.getElementById("cryptoSelect").value;
    const opType = document.getElementById("operationType").value;
    const amount = +document.getElementById("operationAmount").value;

    if (accIndex < 0 || !accounts[accIndex]) {
      alert("Ø§Ø®ØªØ± Ø­Ø³Ø§Ø¨ ØµØ­ÙŠØ­");
      return;
    }
    if (!amount || amount <= 0) {
      alert("Ø§Ø¯Ø®Ù„ ÙƒÙ…ÙŠØ© ØµØ­ÙŠØ­Ø©");
      return;
    }

    const acc = accounts[accIndex];
    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø´Ø±Ø§Ø¡ ÙÙ‚Ø·
    if (opType === "buy") {
      const boughtToday = acc.operations.filter(op => op.crypto === cryptoKey && op.type === "buy").reduce((a,v) => a + v.amount, 0);
      if (boughtToday + amount > dailyLimits[cryptoKey]) {
        alert(`ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø´Ø±Ø§Ø¡ Ù„Ù„Ø¹Ù…Ù„Ø© ${cryptos[cryptoKey].name}`);
        return;
      }
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
    let priceBefore = cryptos[cryptoKey].price;
    let priceAfter;
    if (opType === "buy") {
      // Ø§Ù„Ø³Ø¹Ø± ÙŠØ²ÙŠØ¯ 20% Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø© ØªÙ… Ø´Ø±Ø§Ø¤Ù‡Ø§
      priceAfter = priceBefore * (1 + 0.20 * amount);
      acc.balances[cryptoKey] += amount;
    } else {
      // Ø¨ÙŠØ¹ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¯ ÙŠÙˆÙ…ÙŠ Ù„ÙƒÙ† Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¨ÙŠØ¹ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
      if (acc.balances[cryptoKey] < amount) {
        alert("Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¨ÙŠØ¹Ù‡Ø§ Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªÙˆÙØ±");
        return;
      }
      priceAfter = priceBefore * (1 - 0.15 * amount);
      acc.balances[cryptoKey] -= amount;
    }
text += `${opName} ${amount} ${cryptos[cryptoKey].name}\n`;
    text += `Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ${cardCode}\n`;
    text += `${(cryptos[cryptoKey].price * amount).toFixed(2)}G`;

    textEl.textContent = text;
    lastOpDiv.classList.remove("hidden");

    // Ø­ÙØ¸ Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø®ÙŠØ± Ù„Ù„Ù†Ø³Ø®
    lastOperationCopy = text;
  }

  function clearLastOperation() {
    document.getElementById("lastOperation").classList.add("hidden");
    document.getElementById("lastOperationText").textContent = "";
    lastOperationCopy = "";
  }

  let lastOperationCopy = "";
  function copyLastOperation() {
    if (lastOperationCopy) {
      navigator.clipboard.writeText(lastOperationCopy).then(() => {
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!");
      });
    }
  }

  // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
  function renderPriceEditTable() {
    const tbody = document.getElementById("priceEditTable");
    tbody.innerHTML = "";
    for (let key in cryptos) {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${cryptos[key].name}</td>
        <td>${cryptos[key].price.toFixed(2)}G</td>
        <td><input type="number" id="price_${key}" value="${cryptos[key].price.toFixed(2)}" step="0.01" /></td>
      `;
      tbody.appendChild(tr);
    }
  }

  // Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©
  function savePrices() {
    for (let key in cryptos) {
      const val = parseFloat(document.getElementById("price_" + key).value);
      if (!isNaN(val) && val > 0) {
        cryptos[key].price = val;
      }
    }
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©!");
    renderPriceEditTable();
  }

  // ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
  function updateOperationsLog() {
    const logArea = document.getElementById("operationsLog");
    let logs = [];
    accounts.forEach(acc => {
      acc.operations.forEach(op => {
        logs.push(
          `${acc.code} | ${op.type.toUpperCase()} ${op.amount} ${cryptos[op.crypto].name} | ` +
          `Ù‚Ø¨Ù„: ${op.priceBefore.toFixed(2)}G Ø¨Ø¹Ø¯: ${op.priceAfter.toFixed(2)}G | ${op.timestamp.toLocaleString()}`
        );
      });
    });
    logArea.value = logs.join("\n");
  }

  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
  function searchAccounts() {
    const term = document.getElementById("searchAccountInput").value.toLowerCase();
    const resultsDiv = document.getElementById("searchResults");
    resultsDiv.innerHTML = "";

    const results = accounts.filter(acc =>
      acc.name.toLowerCase().includes(term) || acc.code.toLowerCase().includes(term)
    );

    if (results.length === 0) {
      resultsDiv.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</p>";
      return;
    }

    results.forEach(acc => {
      const div = document.createElement("div");
      div.style.border = "1px solid #ffcc00";
      div.style.padding = "10px";
      div.style.margin = "6px";
      div.innerHTML = `
        <b>${acc.name} (${acc.code})</b><br/>
        Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©: ${acc.card}<br/>
        Nano: ${acc.balances.nano} | DASH: ${acc.balances.dash} | BTC: ${acc.balances.btc}<br/>
        <button onclick="requestReport('${acc.code}')">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨</button>
      `;
      resultsDiv.appendChild(div);
    });
  }

  // Ø·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨ Ù…Ø­Ø¯Ø¯
  function requestReport(code) {
    const acc = accounts.find(a => a.code === code);
    if (!acc) return alert("Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

    let report = `ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨: ${acc.name} (${acc.code})\n`;
    report += `Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©: ${acc.card}\n\n`;
    report += `Ø§Ù„Ø£Ø±ØµØ¯Ø©:\nNano: ${acc.balances.nano}\nDASH: ${acc.balances.dash}\nBTC: ${acc.balances.btc}\n\n`;
    report += "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:\n";
    acc.operations.forEach(op => {
      report += `${op.type.toUpperCase()} ${op.amount} ${cryptos[op.crypto].name} Ø¨Ø³Ø¹Ø± ${op.priceBefore.toFixed(2)}G (${op.timestamp.toLocaleString()})\n`;
    });

    alert(report);
  }

  // ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ Ù„ÙƒÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
  function showFullReport() {
    let totalAccounts = accounts.length;
    let totalBuys = 0;
    let totalSells = 0;
    let report = `ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…:\nØ¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª: ${totalAccounts}\n\n`;

    accounts.forEach(acc => {
      acc.operations.forEach(op => {
        if (op.type === "buy") totalBuys++;
        if (op.type === "sell") totalSells++;
      });
    });

    report += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø´Ø±Ø§Ø¡: ${totalBuys}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ¹: ${totalSells}\n\n`;

    accounts.forEach(acc => {
      report += `- ${acc.code} (${acc.name}): Nano ${acc.balances.nano}, DASH ${acc.balances.dash}, BTC ${acc.balances.btc}\n`;
    });

    document.getElementById("fullReport").value = report;
  }

  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØ£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª
  function resetAll() {
    accounts.forEach(acc => {
      acc.operations = [];
    });
    cryptos.nano.price = 120;
    cryptos.dash.price = 250;
    cryptos.btc.price = 1000;
    updateOperationsLog();
    renderPriceEditTable();
    document.getElementById("fullReport").value = "";
    alert("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±!");
  }
</script>
</body>
</html>